{% extends "base.html" %}
{% load static %}

{% block title %}Ban Giám Đốc - Cổng chấm điểm{% endblock %}

{% block content %}
<div class="pt-20 pb-6 px-3 min-h-[100vh] flex flex-col">
  <div class="mb-4 text-center text-slate-100">
    <p class="text-sm text-slate-300">Xin chào</p>
    <h1 class="text-xl font-semibold">
      {{ bgd.ten }}
    </h1>
    <p class="mt-1 text-xs text-slate-400">
      Mã BGD:
      <span class="font-mono tracking-wide text-amber-300">{{ bgd.maBGD }}</span>
    </p>

    {% if ct %}
    <p class="mt-3 text-sm">
      Cuộc thi:
      <span class="font-semibold">{{ ct.ma }} — {{ ct.tenCuocThi }}</span>
    </p>
    <p class="mt-1 text-xs text-slate-400">
      Đang hiển thị tối đa 5 thí sinh đầu tiên.
    </p>
    {% endif %}
  </div>

  {% if ct and contestants %}
  <div class="flex-1">
    <div class="flex overflow-x-auto snap-x snap-mandatory space-x-4 -mx-3 px-3 pb-6">
      {% for ts in contestants %}
      <div class="min-w-full flex justify-center snap-center">
        <div
          class="w-full max-w-md rounded-3xl border border-slate-700/70 bg-slate-900/90 shadow-xl px-4 py-5 flex flex-col items-center">
          <div
            class="w-full aspect-[4/5] max-w-xs rounded-2xl overflow-hidden bg-slate-800 flex items-center justify-center mb-4">
            {% if ts.display_image_url %}
            <img src="{{ ts.display_image_url }}" alt="{{ ts.hoTen }}" class="h-full w-full object-cover">
            {% else %}
            <div class="text-slate-400 text-sm text-center px-4">
              Không có ảnh cho thí sinh này.
            </div>
            {% endif %}
          </div>

          <div class="text-center mb-3">
            <p class="text-lg font-semibold text-slate-50">
              {{ ts.hoTen }}
            </p>
            <p class="text-xs text-slate-400 mt-0.5">
              Mã NV:
              <span class="font-mono tracking-wide">{{ ts.maNV }}</span>
            </p>
            <p class="text-[11px] text-slate-500 mt-0.5">
              Thí sinh {{ forloop.counter }} / {{ contestants|length }}
            </p>
          </div>

          <div class="w-full mt-4">
            <label class="block text-xs font-medium text-slate-300">
              Điểm (0 – 10)
            </label>
            <div class="mt-2 flex flex-col items-center gap-3">
              <input type="number" min="0" max="10" step="0.5" value="0"
                class="w-24 rounded-2xl border border-slate-600 bg-slate-900 px-3 py-1.5 text-center text-base font-semibold text-slate-50 focus:outline-none focus:ring-2 focus:ring-amber-400 focus:border-amber-400"
                data-role="score-input" data-ts-index="{{ forloop.counter0 }}">
              <input type="range" min="0" max="10" step="1" value="0" class="w-full accent-amber-400"
                data-role="score-slider" data-ts-index="{{ forloop.counter0 }}">
            </div>
          </div>


          <div class="w-full mt-4 flex justify-center">
            <button type="button"
              class="inline-flex items-center justify-center rounded-full bg-amber-400 px-6 py-2 text-sm font-semibold text-slate-900 shadow-md active:scale-95 transition">
              Lưu điểm (chưa kết nối)
            </button>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  {% else %}
  <div class="mt-6 text-center text-sm text-red-300">
    Không tìm thấy cuộc thi "Chung Kết" hoặc chưa có thí sinh để chấm.
  </div>
  {% endif %}
</div>
{% endblock %}